# Matrix Decomposition

Проект по построению рекомендательной системы фильмов с использованием матричной факторизации (Matrix Factorization). Идея данного пэт проекта возникла после изучения курса по линейной алгебре и знакомства с историей Netflix Prize 2006 года, где этот метод показал впечатляющие результаты.

Ключевой результат: модель предсказывает оценки пользователей на ~12% точнее среднего рейтинга КиноПоиска.

Проект на Kaggle: [Matrix Decomposition](https://www.kaggle.com/code/ivan4956/matrix-decomposition) *(рекомендую смотреть там - удобнее читать notebook)*

---

## Данные

Данные собраны путем парсинга **КиноПоиска**:
- 309 пользователей
- 4,495 фильмов (после фильтрации)
- 108,769 оценок (после очистки)
- Разряженность матрицы: 7.8%

---

## Основные этапы

#### 1. СБОР ДАННЫХ

- Парсинг профилей пользователей КиноПоиска
- Извлечение оценок, информации о фильмах (год, длительность, рейтинг)
- Формирование датасета размером ~130,000 записей

#### 2. ПРЕДОБРАБОТКА

**Очистка данных:**
- Удаление оценок "1" (считаются социальным артефактом, а не объективной оценкой)
- Исключение фильмов с менее чем 5 оценками (для статистической значимости)
- Финальный датасет: 108,769 оценок

**Подготовка к моделированию:**
- Train/Test split: 90% / 10%
- Создание матрицы "пользователь-фильм" (pivot table)
- Формирование бинарной маски для отслеживания известных оценок

#### 3. МАТРИЧНАЯ ФАКТОРИЗАЦИЯ

**Алгоритм:**
- Разложение разряженной матрицы R ≈ P × Q
- Метод оптимизации: градиентный спуск
- Параметры модели:
  - Количество скрытых факторов: K = 80
  - Итераций: 400
  - Learning rate: 0.001
  - Регуляризация (λ): 0.015

**Метрики:**
- Loss (MSE на train): 0.547
- RMSE на test: 1.178

#### 4. АНАЛИЗ РЕЗУЛЬТАТОВ

|  | RMSE |
|-------|------|
| Рейтинг КиноПоиска | 1.334 |
| Матричная факторизация | 1.178 |
| Улучшение | 11.7% |

Матричная факторизация эффективно восстанавливает пропущенные значения в разряженной матрице.

Модель превосходит средний рейтинг КиноПоиска (генеральную совокупность).

---

## Итог

В проекте получилось воссоздать рекомендательную систему (наподобии Netflix), используя 100к оценок КиноПоиска. Подтверждена эффективность матричной факторизации в рекомендательных системах. Данный метод не ограничивается только предсказанием рейтингов фильмов - его можно применять в различных бизнес-задачах, где есть большое количество пользователей, товаров и оценок, например:

- E-commerce (рекомендации товаров)
- Стриминговых сервисах (фильмы, музыка)
- Онлайн-образовании (курсы, материалы)
- Контентных платформах (статьи, новости)

Любая задача с разряженной матрицей "пользователь-объект" может быть решена этим методом.


## Технический стек

`Python` • `NumPy` • `Pandas` • `Matplotlib` • `Seaborn`


